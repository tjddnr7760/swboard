<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}" href="../static/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 560px;
        }
        .field-error {
            border-color: #dc3545;
            color: #dc3545;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="py-5 text-center">
        <h2>SW BOARD 게시글 등록</h2>
    </div>

    <div>
        <input type="hidden" id="name" class="form-control" value="testUser" placeholder="Title">
    </div>

    <div>
        <label for="title">Title</label>
        <input type="text" id="title" class="form-control" placeholder="제목을 입력하세요.">
    </div>

    <div>
        <label for="body">Body</label>
        <textarea cols="150" rows="10" id="body" class="form-control" placeholder="내용을 입력하세요."></textarea>
    </div>

    <hr class="my-4">

    <div class="row">
        <div class="col">
            <button class="w-100 btn btn-primary btn-lg" onclick="submitForm()">저장</button>
        </div>
    </div>

    <script>
        function submitForm() {
            var title = document.getElementById('title').value;
            var body = document.getElementById('body').value;

            var accessToken = localStorage.getItem('accessToken');

            var headers = new Headers();
            headers.append('Authorization', 'Bearer ' + accessToken);
            headers.append('Content-Type', 'application/json');

            var data = {
                title: title,
                body: body
            };

            var form = new FormData();
            form.append('title', title);
            form.append('body', body);

            fetch('/board', {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    window.location.href = '/board/main/1';
                } else {
                        throw new Error('POST request failed');
                }
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
        }
    </script>

</div> <!-- /container -->
</body>
</html>
